import{_ as g,m as x,a as y,v as e}from"./app-BZSU0PIB.js";import{I as N,L as B,C as b}from"./ICode-Co9y4WSM.js";import{I as U,a as R,b as E}from"./IMore-D0QgziEM.js";const L={name:"Users",components:{IMore:U,IModeration:R,IVast:E,ICode:N,Loading:B,Code:b},data(){return{search:"",dialog:!1,phone:"",usersHeaders:[{title:"id",key:"id"},{title:"Вход",key:"entrance"},{title:"Имя",key:"name"},{title:"Псевдоним",key:"nicname"},{title:"Роли",key:"roles"},{title:"Телефон",key:"phone"},{title:"link",sortable:!1,key:"link"},{title:"",align:"end",sortable:!1,key:"actions"}]}},methods:{create(){this.actUserCreate({phone:this.phone,roles:this.getRoles.filter(o=>o.value).map(o=>o.name)})},editItem(o){},...x("users",["actReqwestUsers","actReqwestUserRoles","actUserCreate","actUserCreateLink"])},computed:{searchItems(){var c;let o=this.getUsers,n=this.getRolesSelect.filter(l=>l.value).length,i=(c=this.getRolesSelect.filter(l=>l.value))==null?void 0:c.map(l=>l.name);return!this.search&&!n?this.getUsers:(this.search&&(o=this.getUsers.filter(l=>l.phone.search(this.search)>-1)),n&&(o=o.filter(l=>l.roles.map(r=>r.name).filter(r=>i.includes(r)).length)),o)},...y("users",["getUsers","getRoles","getLoad","getRolesSelect"])},created(){this.actReqwestUsers(),this.actReqwestUserRoles()}},I={class:"tw-flex tw-flex-col md:tw-flex-row tw-gap-[15px] tw-mb-5 tw-justify-center"},M={class:"tw-w-full"},S={class:"tw-flex tw-flex-col md:tw-flex-row"},T={key:0},q={class:"tw-flex tw-flex-col md:tw-flex-row tw-justify-between"},z={class:"tw-w-full md:tw-w-1/3"},H={class:"tw-flex tw-gap-3 tw-flex-col md:tw-flex-row"},j={style:{float:"right"}},A=e.createElementVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M1.59964 3.45737C3.80628 0.250428 8.08538 -0.94687 11.6901 0.811276C15.6603 2.74768 17.3091 7.53595 15.3727 11.5062C13.4363 15.4764 8.64798 17.1251 4.67776 15.1887C3.08138 14.4101 1.81733 13.1467 1.03718 11.5918C0.839085 11.197 0.998557 10.7163 1.39337 10.5182C1.78819 10.3201 2.26884 10.4796 2.46694 10.8744C3.09113 12.1184 4.10063 13.1275 5.379 13.751C8.55518 15.3001 12.3858 13.9811 13.9349 10.8049C15.484 7.62876 14.1651 3.79815 10.9889 2.24902C7.94449 0.764172 4.29884 1.91436 2.63736 4.80937H3.99909C4.44082 4.80937 4.79891 5.16746 4.79891 5.60918C4.79891 6.05091 4.44082 6.409 3.99909 6.409H0.799819C0.358091 6.409 0 6.05091 0 5.60918V2.40991C0 1.96818 0.358091 1.61009 0.799819 1.61009C1.24155 1.61009 1.59964 1.96818 1.59964 2.40991V3.45737Z",fill:"#B0BACD"},null,-1),D=[A],F=["innerHTML"],G=["onClick"];function Z(o,n,i,c,l,a){const r=e.resolveComponent("v-card-title"),d=e.resolveComponent("v-text-field"),m=e.resolveComponent("v-checkbox"),_=e.resolveComponent("v-btn"),p=e.resolveComponent("v-card-text"),u=e.resolveComponent("v-card"),v=e.resolveComponent("v-divider"),h=e.resolveComponent("v-icon"),C=e.resolveComponent("v-skeleton-loader"),w=e.resolveComponent("Code"),f=e.resolveComponent("v-chip"),k=e.resolveComponent("v-data-table"),V=e.resolveComponent("Loading");return o.getUsers&&o.getRoles?(e.openBlock(),e.createBlock(u,{key:0},{default:e.withCtx(()=>[e.createVNode(r,null,{default:e.withCtx(()=>[e.createTextVNode(" Пользователи ")]),_:1}),e.createVNode(p,null,{default:e.withCtx(()=>[e.createVNode(u,null,{default:e.withCtx(()=>[e.createVNode(p,null,{default:e.withCtx(()=>[e.createElementVNode("div",I,[e.createElementVNode("div",M,[e.createVNode(d,{label:"Введите телефон",type:"number",modelValue:l.phone,"onUpdate:modelValue":n[0]||(n[0]=t=>l.phone=t)},null,8,["modelValue"]),e.createElementVNode("div",S,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.getRoles,t=>(e.openBlock(),e.createBlock(m,{"hide-details":"",density:"compact",modelValue:t.value,"onUpdate:modelValue":s=>t.value=s,top:"",label:t.display_name},null,8,["modelValue","onUpdate:modelValue","label"]))),256))])]),o.getRoles?(e.openBlock(),e.createBlock(_,{key:0,class:"tw-mt-2",color:"primary",disabled:!o.getRoles.filter(t=>t.value).length||!l.phone,onClick:a.create},{default:e.withCtx(()=>[e.createTextVNode("Создать пользователя ")]),_:1},8,["disabled","onClick"])):e.createCommentVNode("",!0)])]),_:1})]),_:1}),e.createVNode(v,{class:"tw-my-3",color:"blue"}),o.getUsers?(e.openBlock(),e.createElementBlock("div",T,[e.createElementVNode("div",q,[e.createElementVNode("div",z,[e.createVNode(d,{clearable:"",type:"number",label:"Поиск по номеру телефона",modelValue:l.search,"onUpdate:modelValue":n[1]||(n[1]=t=>l.search=t)},null,8,["modelValue"])]),e.createElementVNode("div",H,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.getRolesSelect,t=>(e.openBlock(),e.createBlock(m,{"hide-details":"",density:"compact",modelValue:t.value,"onUpdate:modelValue":s=>t.value=s,top:"",label:t.display_name},null,8,["modelValue","onUpdate:modelValue","label"]))),256))])]),e.createVNode(k,{"onClick:row":n[3]||(n[3]=t=>l.dialog=!l.dialog),headers:l.usersHeaders,items:a.searchItems,loading:o.getLoad},{"item.actions":e.withCtx(({item:t})=>[e.createVNode(h,{class:"me-2",size:"small",onClick:e.withModifiers(s=>a.editItem(t),["stop"])},{default:e.withCtx(()=>[e.createTextVNode(" mdi-pencil ")]),_:2},1032,["onClick"]),e.createVNode(h,{size:"small",onClick:e.withModifiers(s=>o.deleteItem(t),["stop"])},{default:e.withCtx(()=>[e.createTextVNode(" mdi-delete ")]),_:2},1032,["onClick"])]),"header.actions":e.withCtx(()=>[e.createElementVNode("div",j,[(e.openBlock(),e.createElementBlock("svg",{class:"tw-cursor-pointer",onClick:n[2]||(n[2]=e.withModifiers((...t)=>o.actReqwestUsers&&o.actReqwestUsers(...t),["stop"])),width:"17",height:"16",viewBox:"0 0 17 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},D))])]),loading:e.withCtx(()=>[e.createVNode(C,{type:"table-row@10"})]),"item.roles":e.withCtx(({item:t})=>[e.createElementVNode("div",{innerHTML:t.roles.map(s=>s.display_name).join(", "),style:{"font-size":"12px"}},null,8,F)]),"item.link":e.withCtx(({item:t})=>[t.entry_code?(e.openBlock(),e.createBlock(w,{key:0,code:t.entry_code},null,8,["code"])):(e.openBlock(),e.createElementBlock("div",{key:1,onClick:s=>o.actUserCreateLink({uid:t.id})}," сгенерить ключ ",8,G))]),"item.entrance":e.withCtx(({item:t})=>[e.createVNode(f,{color:t.authorized_at?"green":"grey"},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(t.authorized_at?t.authorized_at:"не заходил"),1)]),_:2},1032,["color"])]),_:1},8,["headers","items","loading"])])):e.createCommentVNode("",!0)]),_:1})]),_:1})):(e.openBlock(),e.createBlock(V,{key:1}))}const P=g(L,[["render",Z]]);export{P as default};
